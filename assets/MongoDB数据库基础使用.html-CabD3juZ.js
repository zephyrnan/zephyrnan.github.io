import{_ as t,c as s,a as n,o as a}from"./app-DiRdVEu8.js";const l={};function d(i,e){return a(),s("div",null,[...e[0]||(e[0]=[n('<h1 id="mongodb-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨" tabindex="-1"><a class="header-anchor" href="#mongodb-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨"><span>MongoDB å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨</span></a></h1><h2 id="_1-ç»ˆç«¯ä¸æœåŠ¡ç®¡ç†-cli" tabindex="-1"><a class="header-anchor" href="#_1-ç»ˆç«¯ä¸æœåŠ¡ç®¡ç†-cli"><span>1. ç»ˆç«¯ä¸æœåŠ¡ç®¡ç† (CLI)</span></a></h2><h3 id="æœåŠ¡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡æ§åˆ¶"><span>æœåŠ¡æ§åˆ¶</span></a></h3><table><thead><tr><th style="text-align:left;">å¹³å°</th><th style="text-align:left;">å¯åŠ¨æœåŠ¡</th><th style="text-align:left;">åœæ­¢æœåŠ¡</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Windows</strong></td><td style="text-align:left;"><code>net start MongoDB</code></td><td style="text-align:left;"><code>net stop MongoDB</code></td></tr><tr><td style="text-align:left;"><strong>Mac (Brew)</strong></td><td style="text-align:left;"><code>brew services start mongodb-community</code></td><td style="text-align:left;"><code>brew services stop mongodb-community</code></td></tr><tr><td style="text-align:left;"><strong>Linux</strong></td><td style="text-align:left;"><code>sudo systemctl start mongod</code></td><td style="text-align:left;"><code>sudo systemctl stop mongod</code></td></tr></tbody></table><h3 id="å¸¸ç”¨å·¥å…·å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨å·¥å…·å‘½ä»¤"><span>å¸¸ç”¨å·¥å…·å‘½ä»¤</span></a></h3><p>```bash</p><h1 id="æŒ‡å®šæ•°æ®ç›®å½•å¯åŠ¨-è°ƒè¯•ç”¨" tabindex="-1"><a class="header-anchor" href="#æŒ‡å®šæ•°æ®ç›®å½•å¯åŠ¨-è°ƒè¯•ç”¨"><span>æŒ‡å®šæ•°æ®ç›®å½•å¯åŠ¨ (è°ƒè¯•ç”¨)</span></a></h1><p>mongod --dbpath &quot;E:\\data\\db&quot;</p><h1 id="è¿æ¥æ•°æ®åº“-shell" tabindex="-1"><a class="header-anchor" href="#è¿æ¥æ•°æ®åº“-shell"><span>è¿æ¥æ•°æ®åº“ Shell</span></a></h1><p>mongosh # æ–°ç‰ˆ (æ¨è) mongo # æ—§ç‰ˆ</p><h1 id="å¤‡ä»½æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#å¤‡ä»½æ•°æ®åº“"><span>å¤‡ä»½æ•°æ®åº“</span></a></h1><p>mongodump --db myapp --out ./backup</p><h1 id="æ¢å¤æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#æ¢å¤æ•°æ®åº“"><span>æ¢å¤æ•°æ®åº“</span></a></h1><p>mongorestore --db myapp ./backup/myapp</p><h1 id="docker-å¿«é€Ÿå¯åŠ¨" tabindex="-1"><a class="header-anchor" href="#docker-å¿«é€Ÿå¯åŠ¨"><span>Docker å¿«é€Ÿå¯åŠ¨</span></a></h1><p>docker run -d --name mongodb -p 27017:27017 mongo docker exec -it mongodb mongosh ```</p><hr><h2 id="_2-shell-äº¤äº’å‘½ä»¤-mongosh" tabindex="-1"><a class="header-anchor" href="#_2-shell-äº¤äº’å‘½ä»¤-mongosh"><span>2. Shell äº¤äº’å‘½ä»¤ (mongosh)</span></a></h2><h3 id="æ•°æ®åº“ä¸é›†åˆ" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“ä¸é›†åˆ"><span>æ•°æ®åº“ä¸é›†åˆ</span></a></h3><p>```javascript show dbs // æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ use my_database // åˆ‡æ¢/åˆ›å»ºæ•°æ®åº“ db // æŸ¥çœ‹å½“å‰æ•°æ®åº“å show collections // æŸ¥çœ‹å½“å‰åº“æ‰€æœ‰é›†åˆ db.stats() // æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€ db.dropDatabase() // âš ï¸ åˆ é™¤å½“å‰æ•°æ®åº“ db.users.drop() // âš ï¸ åˆ é™¤ users é›†åˆ ```</p><h3 id="å¢-create" tabindex="-1"><a class="header-anchor" href="#å¢-create"><span>å¢ (Create)</span></a></h3><p>```javascript // æ’å…¥å•æ¡ db.users.insertOne({ name: &quot;Alice&quot;, age: 25 })</p><p>// æ’å…¥å¤šæ¡ db.users.insertMany([ { name: &quot;Bob&quot;, age: 22 }, { name: &quot;Charlie&quot;, age: 30 } ]) ```</p><h3 id="æŸ¥-read" tabindex="-1"><a class="header-anchor" href="#æŸ¥-read"><span>æŸ¥ (Read)</span></a></h3><p>```javascript // åŸºç¡€æŸ¥è¯¢ db.users.find() // æŸ¥æ‰€æœ‰ db.users.find().pretty() // æ ¼å¼åŒ–è¾“å‡º db.users.findOne({ name: &quot;Alice&quot; }) // æŸ¥ä¸€æ¡</p><p>// æ¡ä»¶ä¸æŠ•å½± db.users.find({ age: { $gt: 18 } }, { name: 1, email: 1, _id: 0 })</p><p>// æ’åºã€åˆ†é¡µ db.users.find() .sort({ age: -1 }) // -1 é™åº, 1 å‡åº .skip(10) // è·³è¿‡å‰10æ¡ .limit(5) // å–5æ¡</p><p>// ç»Ÿè®¡æ•°é‡ db.users.countDocuments({ age: { $gte: 18 } }) ```</p><h3 id="æ”¹-update" tabindex="-1"><a class="header-anchor" href="#æ”¹-update"><span>æ”¹ (Update)</span></a></h3><p>```javascript // æ›´æ–°å•æ¡ db.users.updateOne( { name: &quot;Alice&quot; }, { $set: { age: 26 } } )</p><p>// è‡ªå¢/è‡ªå‡ db.users.updateOne( { name: &quot;Alice&quot; }, { $inc: { views: 1 } } )</p><p>// æ•°ç»„æ“ä½œ db.users.updateOne( { name: &quot;Alice&quot; }, { $push: { tags: &quot;admin&quot; } } )</p><p>// Upsert db.users.updateOne( { name: &quot;David&quot; }, { $set: { age: 20 } }, { upsert: true } ) ```</p><h3 id="åˆ -delete" tabindex="-1"><a class="header-anchor" href="#åˆ -delete"><span>åˆ  (Delete)</span></a></h3><p>```javascript db.users.deleteOne({ name: &quot;Alice&quot; }) db.users.deleteMany({ status: &quot;inactive&quot; }) ```</p><hr><h2 id="_3-æŸ¥è¯¢æ“ä½œç¬¦-operators" tabindex="-1"><a class="header-anchor" href="#_3-æŸ¥è¯¢æ“ä½œç¬¦-operators"><span>3. æŸ¥è¯¢æ“ä½œç¬¦ (Operators)</span></a></h2><table><thead><tr><th style="text-align:left;">ç±»åˆ«</th><th style="text-align:left;">ç¬¦å·</th><th style="text-align:left;">å«ä¹‰</th><th style="text-align:left;">ç¤ºä¾‹</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>æ¯”è¾ƒ</strong></td><td style="text-align:left;"><code>\\$eq</code> / <code>\\$ne</code></td><td style="text-align:left;">ç­‰äº / ä¸ç­‰äº</td><td style="text-align:left;"><code>{ age: { \\$ne: 18 } }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$gt</code> / <code>\\$gte</code></td><td style="text-align:left;">å¤§äº / å¤§äºç­‰äº</td><td style="text-align:left;"><code>{ age: { \\$gte: 18 } }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$lt</code> / <code>\\$lte</code></td><td style="text-align:left;">å°äº / å°äºç­‰äº</td><td style="text-align:left;"><code>{ price: { \\$lt: 100 } }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$in</code> / <code>\\$nin</code></td><td style="text-align:left;">åœ¨æ•°ç»„ä¸­ / ä¸åœ¨</td><td style="text-align:left;"><code>{ role: { \\$in: [&quot;admin&quot;, &quot;mod&quot;] } }</code></td></tr><tr><td style="text-align:left;"><strong>é€»è¾‘</strong></td><td style="text-align:left;"><code>\\$or</code></td><td style="text-align:left;">æˆ–</td><td style="text-align:left;"><code>{ \\$or: [{ age: 18 }, { vip: true }] }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$and</code></td><td style="text-align:left;">ä¸</td><td style="text-align:left;">(é€šå¸¸çœç•¥)</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$not</code></td><td style="text-align:left;">é</td><td style="text-align:left;"><code>{ age: { \\$not: { \\$lt: 18 } } }</code></td></tr><tr><td style="text-align:left;"><strong>å…ƒç´ </strong></td><td style="text-align:left;"><code>\\$exists</code></td><td style="text-align:left;">å­—æ®µæ˜¯å¦å­˜åœ¨</td><td style="text-align:left;"><code>{ email: { \\$exists: true } }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$type</code></td><td style="text-align:left;">å­—æ®µç±»å‹</td><td style="text-align:left;"><code>{ age: { \\$type: &quot;number&quot; } }</code></td></tr><tr><td style="text-align:left;"><strong>æ•°ç»„</strong></td><td style="text-align:left;"><code>\\$all</code></td><td style="text-align:left;">åŒ…å«æ‰€æœ‰</td><td style="text-align:left;"><code>{ tags: { \\$all: [&quot;js&quot;, &quot;node&quot;] } }</code></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"><code>\\$elemMatch</code></td><td style="text-align:left;">åŒ¹é…æ•°ç»„å†…å¯¹è±¡</td><td style="text-align:left;"><code>{ comments: { \\$elemMatch: { user: &quot;A&quot; } } }</code></td></tr></tbody></table><hr><h2 id="_4-mongoose-å¸¸ç”¨æ–¹æ³•-node-js" tabindex="-1"><a class="header-anchor" href="#_4-mongoose-å¸¸ç”¨æ–¹æ³•-node-js"><span>4. Mongoose å¸¸ç”¨æ–¹æ³• (Node.js)</span></a></h2><p>```javascript const User = require(&#39;./models/User&#39;);</p><p>// é“¾å¼æŸ¥è¯¢ const users = await User.find({ isActive: true }) .select(&#39;name email -_id&#39;) .sort(&#39;-createdAt&#39;) .limit(10) .populate(&#39;profile&#39;) .lean();</p><p>// åˆ›å»º const user = await User.create({ name: &#39;Alice&#39; });</p><p>// æŸ¥æ‰¾å¹¶æ›´æ–° const updated = await User.findByIdAndUpdate( id, { $set: req.body }, { new: true, runValidators: true } );</p><p>// èšåˆ const stats = await User.aggregate([ { $match: { age: { $gte: 18 } } }, { $group: { _id: &quot;$role&quot;, count: { $sum: 1 } } } ]); ```</p><hr><h2 id="_5-ç´¢å¼•ä¸æ€§èƒ½-index" tabindex="-1"><a class="header-anchor" href="#_5-ç´¢å¼•ä¸æ€§èƒ½-index"><span>5. ç´¢å¼•ä¸æ€§èƒ½ (Index)</span></a></h2><p>```javascript // æŸ¥çœ‹ç´¢å¼• db.users.getIndexes()</p><p>// åˆ›å»ºç´¢å¼• db.users.createIndex({ username: 1 }) db.users.createIndex({ email: 1 }, { unique: true })</p><p>// å¤åˆç´¢å¼• db.users.createIndex({ role: 1, createdAt: -1 })</p><p>// æŸ¥è¯¢åˆ†æ db.users.find({ username: &quot;Alice&quot; }).explain(&quot;executionStats&quot;)</p><p>// åˆ é™¤ç´¢å¼• db.users.dropIndex(&quot;email_1&quot;)</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"></span>\n<span class="line">---</span>\n<span class="line"></span>\n<span class="line">## å¿«é€Ÿå‚è€ƒ</span>\n<span class="line"></span>\n<span class="line">**å¸¸ç”¨å‘½ä»¤æ¸…å•ï¼š**</span>\n<span class="line">- `mongosh` - è¿æ¥æ•°æ®åº“</span>\n<span class="line">- `show dbs` - æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</span>\n<span class="line">- `use dbname` - åˆ‡æ¢æ•°æ®åº“</span>\n<span class="line">- `show collections` - æŸ¥çœ‹é›†åˆ</span>\n<span class="line">- `db.collection.find()` - æŸ¥è¯¢æ•°æ®</span>\n<span class="line">- `db.collection.insertOne()` - æ’å…¥æ•°æ®</span>\n<span class="line">- `db.collection.updateOne()` - æ›´æ–°æ•°æ®</span>\n<span class="line">- `db.collection.deleteOne()` - åˆ é™¤æ•°æ®</span>\n<span class="line"></span>\n<span class="line">**æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼š**</span>\n<span class="line">- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•</span>\n<span class="line">- ä½¿ç”¨æŠ•å½±å‡å°‘è¿”å›å­—æ®µ</span>\n<span class="line">- åœ¨ Mongoose ä¸­ä½¿ç”¨ `.lean()` æå‡æŸ¥è¯¢æ€§èƒ½</span>\n<span class="line">- åˆç†ä½¿ç”¨åˆ†é¡µé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®</span>\n<span class="line"></span>\n<span class="line">---</span>\n<span class="line"></span>\n<span class="line">&gt; ğŸ’¡ **æç¤º**ï¼šæœ¬é€ŸæŸ¥è¡¨æ¶µç›–äº†MongoDBæœ€å¸¸ç”¨çš„å‘½ä»¤å’Œæ“ä½œã€‚å»ºè®®æ”¶è—æ­¤é¡µé¢ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­éšæ—¶æŸ¥é˜…ã€‚</span>\n<span class="line"></span>\n<span class="line">&lt;comment-section /&gt;</span>\n<span class="line"></span>\n<span class="line">&lt;style&gt;</span>\n<span class="line">.comment-section {</span>\n<span class="line">  margin-top: 60px;</span>\n<span class="line">  padding-top: 40px;</span>\n<span class="line">  border-top: 2px solid #e0e0e0;</span>\n<span class="line">}</span>\n<span class="line">&lt;/style&gt;</span>\n<span class="line"></span>\n<span class="line">---</span>\n<span class="line"></span>\n<span class="line">**æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„MongoDBä½¿ç”¨ç»éªŒæˆ–æé—®ï¼**</span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',53)])])}const r=t(l,[["render",d]]),c=JSON.parse('{"path":"/posts/nodejs/MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8.html","title":"MongoDB å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","lang":"zh-CN","frontmatter":{"title":"MongoDB å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","date":"2025-11-22T00:00:00.000Z","categories":["Node.js æ·±å…¥å­¦ä¹ "],"tags":["MongoDB","æ•°æ®åº“","Node.js"]},"git":{"updatedTime":1765046795000,"contributors":[{"name":"52nnnn","username":"52nnnn","email":"2764304248@qq.com","commits":2,"url":"https://github.com/52nnnn"},{"name":"Claude","username":"Claude","email":"noreply@anthropic.com","commits":1,"url":"https://github.com/Claude"}],"changelog":[{"hash":"82b916bca35f631eed19f39ea2df3af77f5312e6","time":1765046795000,"email":"2764304248@qq.com","author":"52nnnn","message":"å¢åŠ ä½œå“"},{"hash":"0d0d0a0cd900f97da13cc6102c1b88b20855dbba","time":1763817139000,"email":"2764304248@qq.com","author":"52nnnn","message":"fix: ä¿®å¤MongoDBæ–‡æ¡£æ ¼å¼é—®é¢˜å¹¶å®Œå–„å†…å®¹","coAuthors":[{"name":"Claude","email":"noreply@anthropic.com"}]}]},"filePathRelative":"posts/nodejs/MongoDBæ•°æ®åº“åŸºç¡€ä½¿ç”¨.md"}');export{r as comp,c as data};
